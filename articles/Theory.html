<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Theory Behind gips ‚Ä¢ gips</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Theory Behind gips">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gips</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/gips.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Optimizers.html">Available Optimizers: How to Find Maximum A Posteriori?</a></li>
    <li><a class="dropdown-item" href="../articles/Theory.html">The Theory Behind gips</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PrzeChoj/gips/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The Theory Behind gips</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PrzeChoj/gips/blob/main/vignettes/Theory.Rmd" class="external-link"><code>vignettes/Theory.Rmd</code></a></small>
      <div class="d-none name"><code>Theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-the-gips-is-based-on">What the <code>gips</code> is based on<a class="anchor" aria-label="anchor" href="#what-the-gips-is-based-on"></a>
</h2>
<p>The package is based on the article <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>. There the math behind
the package is precisely demonstrated, and all the theorems are
proven.</p>
<p>In this vignette, we would like to give a gentle introduction. We
want to point out all the most important results from this work from the
user‚Äôs point of view. We will also show examples of those results in the
<code>gips</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PrzeChoj/gips" class="external-link">gips</a></span><span class="op">)</span></span></code></pre></div>
<p>As mentioned in the abstract, the outline of the paper is to ‚Äúderive
the distribution of the maximum likelihood estimate of the covariance
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
(‚Ä¶)‚Äù and then to ‚Äúperform Bayesian model selection in the class of
complete Gaussian models invariant by the action of a subgroup of the
symmetric group (‚Ä¶)‚Äù. Those ideas are implemented in the
<code>gips</code> package.</p>
<div class="section level3">
<h3 id="alternative-reference">Alternative reference<a class="anchor" aria-label="anchor" href="#alternative-reference"></a>
</h3>
<p>The theory derived in [1] is for general group invariance, while in
this package, we only consider invariance under cyclic groups. This
allows for massive simplifications. This simplified version is
comprehensibly set out in [2].</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-definitions">Basic definitions<a class="anchor" aria-label="anchor" href="#basic-definitions"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">V=\{1,\ldots,p\}</annotation></semantics></math>
be a finite index set, and for every
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>n</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">i\in \{1, \dots, n\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Z</mi><mn>1</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msubsup><mi>Z</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">Z^{(i)}=(Z_1^{(i)},\ldots, Z_p^{(i)})^\top</annotation></semantics></math>
be a multivariate random variable following a centered Gaussian model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}_p(0,\Sigma)</annotation></semantics></math>,
and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">Z^{(1)},\ldots, Z^{(n)}</annotation></semantics></math>
be an i.i.d. (independent and identically distributed) sample from this
distribution. Name the whole sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z = (Z^{(1)},\ldots, Z^{(n)})</annotation></semantics></math>.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùîñ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\mathfrak{S}_p</annotation></semantics></math>
denote the symmetric group on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>,
that is, the set of all permutations on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1,\ldots,p\}</annotation></semantics></math>
with function composition as the group operation. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
be an arbitrary subgroup of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùîñ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\mathfrak{S}_p</annotation></semantics></math>.
The model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}_p(0,\Sigma)</annotation></semantics></math>
is said to be invariant under the action of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
if for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>‚àà</mo><mi>Œì</mi></mrow><annotation encoding="application/x-tex">g\in \Gamma</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>‚ãÖ</mo><mi>Œ£</mi><mo>‚ãÖ</mo><msup><mi>g</mi><mi>‚ä§</mi></msup><mo>=</mo><mi>Œ£</mi></mrow><annotation encoding="application/x-tex">g\cdot\Sigma\cdot g^\top=\Sigma</annotation></semantics></math>
(here, we identify a permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
with its permutation matrix).</p>
<p>For a subgroup
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>‚äÇ</mo><msub><mi>ùîñ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\Gamma \subset  \mathfrak{S}_p</annotation></semantics></math>,
we define the colored space, i.e., the space of symmetric matrices
invariant under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùíµ</mi><mi>Œì</mi></msub><mo>:=</mo><mo stretchy="false" form="prefix">{</mo><mi>S</mi><mo>‚àà</mo><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">m</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>;</mo><mi>‚Ñù</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>S</mi><mrow><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for all </mtext><mspace width="0.333em"></mspace></mrow><mi>œÉ</mi><mo>‚àà</mo><mi>Œì</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for all </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mi>V</mi><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathcal{Z}_{\Gamma} := \{S \in \mathrm{Sym}(p;\mathbb{R})\colon S_{i,j} = S_{\sigma(i),\sigma(j)} \text{ for all }\sigma \in \Gamma\mbox{ for all }i,j\in V\},</annotation></semantics></math>
and the colored cone of positive definite matrices valued in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùíµ</mi><mi>Œì</mi></msub><annotation encoding="application/x-tex">\mathcal{Z}_{\Gamma}</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùí´</mi><mi>Œì</mi></msub><mo>:=</mo><msub><mi>ùíµ</mi><mi>Œì</mi></msub><mo>‚à©</mo><msup><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">m</mi></mrow><mo>+</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>;</mo><mi>‚Ñù</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}_{\Gamma} := \mathcal{Z}_{\Gamma} \cap \mathrm{Sym}^+(p;\mathbb{R}).</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="block-decomposition---1-theorem-1">Block Decomposition - [1], Theorem 1<a class="anchor" aria-label="anchor" href="#block-decomposition---1-theorem-1"></a>
</h2>
<p>The main theoretical result in this theory (Theorem 1 in <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>) states that given a
permutation subgroup
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
there exists an orthogonal matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>U</mi><mi>Œì</mi></msub><annotation encoding="application/x-tex">U_\Gamma</annotation></semantics></math>
such that all the symmetric matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>‚àà</mo><msub><mi>ùíµ</mi><mi>Œì</mi></msub></mrow><annotation encoding="application/x-tex">S\in\mathcal{Z}_\Gamma</annotation></semantics></math>
can be transformed into block-diagonal form.</p>
<p>The exact form of blocks depends on so-called <em>structure
constants</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>,</mo><msub><mi>d</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></msubsup><annotation encoding="application/x-tex">(k_i,d_i,r_i)_{i=1}^L</annotation></semantics></math>.
It is worth pointing out that constants
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">k = d</annotation></semantics></math>
for cyclic group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mi>œÉ</mi><mo stretchy="true" form="postfix">‚ü©</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma = \left&lt;\sigma\right&gt;</annotation></semantics></math>
and that <code>gips</code> searches within cyclic subgroups only.</p>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>,</span>
<span>  <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>,</span>
<span>  <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span>  <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>,</span>
<span>  <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>,</span>
<span>  <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_2-1.png" width="700"></p>
<p><code>S</code> is a symmetric matrix invariant under the group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">‚ü©</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma = \left&lt;(1,2,3,4,5,6)\right&gt;</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips_perm.html">gips_perm</a></span><span class="op">(</span><span class="st">"(1,2,3,4,5,6)"</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">U_Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_orthogonal_matrix.html">prepare_orthogonal_matrix</a></span><span class="op">(</span><span class="va">g_perm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">block_decomposition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">U_Gamma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">U_Gamma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">block_decomposition</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]  5.2  0.0  0.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [2,]  0.0  0.5  0.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [3,]  0.0  0.0  0.5  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [4,]  0.0  0.0  0.0  0.1  0.0  0.0</span></span>
<span><span class="co">#&gt; [5,]  0.0  0.0  0.0  0.0  0.1  0.0</span></span>
<span><span class="co">#&gt; [6,]  0.0  0.0  0.0  0.0  0.0  0.2</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_4-1.png" width="700"></p>
<p>The transformed matrix is in the block-diagonal form of <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>, Theorem 1. Blank
entries are off-block entries and equal to 0. Notice that, for example,
the [2,3] is not blank regardless of being 0. This is because it is a
part of the block-diagonal form but happens to have a value of 0.</p>
<p>The result was rounded to the 5th place after the decimal to hide the
inaccuracies of floating point arithmetic.</p>
<p>Let‚Äôs see the other example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>,</span>
<span>  <span class="fl">0.9</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>,</span>
<span>  <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">1.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>,</span>
<span>  <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>,</span>
<span>  <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>,</span>
<span>  <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">1.2</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_6-1.png" width="700"></p>
<p>Now, <code>S</code> is a symmetric matrix invariant under the group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">‚ü©</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma = \left&lt;(1,2,3)(4,5,6)\right&gt;</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips_perm.html">gips_perm</a></span><span class="op">(</span><span class="st">"(1,2,3)(4,5,6)"</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">U_Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_orthogonal_matrix.html">prepare_orthogonal_matrix</a></span><span class="op">(</span><span class="va">g_perm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">block_decomposition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">U_Gamma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">U_Gamma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">block_decomposition</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]   [,3]    [,4]    [,5]   [,6]</span></span>
<span><span class="co">#&gt; [1,]  3.0  0.7 0.0000  0.0000  0.0000 0.0000</span></span>
<span><span class="co">#&gt; [2,]  0.7  3.0 0.0000  0.0000  0.0000 0.0000</span></span>
<span><span class="co">#&gt; [3,]  0.0  0.0 0.3000  0.0000  0.2500 0.0866</span></span>
<span><span class="co">#&gt; [4,]  0.0  0.0 0.0000  0.3000 -0.0866 0.2500</span></span>
<span><span class="co">#&gt; [5,]  0.0  0.0 0.2500 -0.0866  0.3000 0.0000</span></span>
<span><span class="co">#&gt; [6,]  0.0  0.0 0.0866  0.2500  0.0000 0.3000</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_8-1.png" width="700"></p>
<p>Again, this result is in accordance with <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>, Theorem 1. Notice the
zeros in <code>block_decomposition</code>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚àÄ</mo><mrow><mi>i</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo><mo>,</mo><mi>j</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="false" form="postfix">}</mo></mrow></msub><mtext mathvariant="normal">block_decomposition</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\forall_{i\in\{1,2\},j\in\{3,4,5,6\}}\text{block_decomposition}[i,j] = 0</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="project-matrix---1-eq--6">Project Matrix - [1, Eq. (6)]<a class="anchor" aria-label="anchor" href="#project-matrix---1-eq--6"></a>
</h2>
<p>One can also take any symmetric square matrix <code>S</code> and find
the orthogonal projection on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùíµ</mi><mi>Œì</mi></msub><annotation encoding="application/x-tex">\mathcal{Z}_{\Gamma}</annotation></semantics></math>,
the space of matrices invariant under the given permutation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mi>Œì</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mfrac><mn>1</mn><mrow><mo stretchy="true" form="prefix">|</mo><mi>Œì</mi><mo stretchy="true" form="postfix">|</mo></mrow></mfrac><munder><mo>‚àë</mo><mrow><mi>œÉ</mi><mo>‚àà</mo><mi>Œì</mi></mrow></munder><mi>œÉ</mi><mo>‚ãÖ</mo><mi>S</mi><mo>‚ãÖ</mo><msup><mi>œÉ</mi><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">\pi_\Gamma(S) := \frac{1}{|\Gamma|}\sum_{\sigma\in\Gamma}\sigma\cdot S\cdot\sigma^\top</annotation></semantics></math></p>
<p>The projected matrix is the element of the cone
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mi>Œì</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àà</mo><msub><mi>ùíµ</mi><mi>Œì</mi></msub></mrow><annotation encoding="application/x-tex">\pi_\Gamma(S)\in\mathcal{Z}_{\Gamma}</annotation></semantics></math>,
which means:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚àÄ</mo><mrow><mi>i</mi><mo>,</mo><mi>j</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mspace width="0.222em"></mspace><mi>‚Ä¶</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow></msub><msub><mi>œÄ</mi><mi>Œì</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>œÄ</mi><mi>Œì</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>œÉ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> for all </mtext><mspace width="0.333em"></mspace></mrow><mi>œÉ</mi><mo>‚àà</mo><mi>Œì</mi></mrow><annotation encoding="application/x-tex">\forall_{i,j\in \{1,\ \dots,\ p\}} \pi_\Gamma(S)[i,j] = \pi_\Gamma(S)[\sigma(i),\sigma(j)] \text{ for all }\sigma\in\Gamma</annotation></semantics></math></p>
<p>So it has some identical elements.</p>
<div class="section level4">
<h4 id="trivial-case">Trivial case<a class="anchor" aria-label="anchor" href="#trivial-case"></a>
</h4>
<p>Note that for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚Ä¶</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Gamma = \{\text{id}\} = \{(1)(2)\dots(p)\}</annotation></semantics></math>
we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mrow><mo stretchy="false" form="prefix">{</mo><mtext mathvariant="normal">id</mtext><mo stretchy="false" form="postfix">}</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">\pi_{\{\text{id}\}}(S) = S</annotation></semantics></math>.</p>
<p>So, no additional assumptions are made; thus, the standard covariance
estimator is the best we can do.</p>
</div>
<div class="section level4">
<h4 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h4>
<p>We will abbreviate the notation: when the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mi>c</mi><mo stretchy="true" form="postfix">‚ü©</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma = \left&lt; c \right&gt;</annotation></semantics></math>
is a cyclic group of a permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
we will write
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><msub><mi>œÄ</mi><mi>Œì</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>œÄ</mi><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mi>c</mi><mo stretchy="true" form="postfix">‚ü©</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{c}(S) := \pi_{\Gamma}(S) = \pi_{\left&lt; c \right&gt;}(S)</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>Let <code>S</code> be any symmetric square matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]</span></span>
<span><span class="co">#&gt; [1,] 137.51 -16.21  10.03   0.16 -24.35 -17.42</span></span>
<span><span class="co">#&gt; [2,] -16.21  34.08 -10.62  15.93  12.23  -2.74</span></span>
<span><span class="co">#&gt; [3,]  10.03 -10.62  35.47   3.10  -3.81  -9.60</span></span>
<span><span class="co">#&gt; [4,]   0.16  15.93   3.10  26.74   7.71 -13.51</span></span>
<span><span class="co">#&gt; [5,] -24.35  12.23  -3.81   7.71  26.00  -7.24</span></span>
<span><span class="co">#&gt; [6,] -17.42  -2.74  -9.60 -13.51  -7.24  16.77</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/def3_2-1.png" width="700"></p>
<p>One can project this matrix, for example, on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mtext mathvariant="normal">perm</mtext><mo stretchy="true" form="postfix">‚ü©</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">‚ü®</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">‚ü©</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma = \left&lt; \text{perm} \right&gt; = \left&lt;(1,2)(3,4,5,6)\right&gt;</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S_projected</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]  [,3]  [,4]  [,5]  [,6]</span></span>
<span><span class="co">#&gt; [1,]  85.80 -16.21 -0.28 -3.91 -0.28 -3.91</span></span>
<span><span class="co">#&gt; [2,] -16.21  85.80 -3.91 -0.28 -3.91 -0.28</span></span>
<span><span class="co">#&gt; [3,]  -0.28  -3.91 26.25 -1.51 -8.66 -1.51</span></span>
<span><span class="co">#&gt; [4,]  -3.91  -0.28 -1.51 26.25 -1.51 -8.66</span></span>
<span><span class="co">#&gt; [5,]  -0.28  -3.91 -8.66 -1.51 26.25 -1.51</span></span>
<span><span class="co">#&gt; [6,]  -3.91  -0.28 -1.51 -8.66 -1.51 26.25</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/def3_4-1.png" width="700"></p>
<p>Notice in the <code>S_projected</code> matrix there are identical
elements according to the equation from the beginning of this section.
For example, <code>S_projected[1,1] = S_projected[2,2]</code>.</p>
</div>
<div class="section level3">
<h3 id="c_sigma-and-n0">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>œÉ</mi></msub><annotation encoding="application/x-tex">C_\sigma</annotation></semantics></math>
and <code>n0</code><a class="anchor" aria-label="anchor" href="#c_sigma-and-n0"></a>
</h3>
<p>It is a well-known fact that without additional assumptions, the
Maximum Likelihood Estimator (MLE) of the covariance matrix in the
Gaussian model exists if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚â•</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \ge p</annotation></semantics></math>.
However, if the additional assumption is added as the covariance matrix
is invariant under permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>,
then the sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
required for the MLE to exist is lower than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.
It is equal to the number of cycles, denoted hereafter by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>œÉ</mi></msub><annotation encoding="application/x-tex">C_\sigma</annotation></semantics></math>.</p>
<p>For example, if the permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÉ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma = (1,2,3,4,5,6)</annotation></semantics></math>
is discovered by the <code><a href="../reference/find_MAP.html">find_MAP()</a></code> function, then there is a
single cycle in it
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>œÉ</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">C_\sigma = 1</annotation></semantics></math>.
Therefore a single observation would be enough to estimate a covariance
matrix with <code><a href="../reference/project_matrix.html">project_matrix()</a></code>. If the permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÉ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma = (1,2)(3,4,5,6)</annotation></semantics></math>
is discovered, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>œÉ</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">C_\sigma = 2</annotation></semantics></math>,
and so 2 observations would be enough.</p>
<p>To get this
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>œÉ</mi></msub><annotation encoding="application/x-tex">C_\sigma</annotation></semantics></math>
number in <code>gips</code>, one can call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on the
appropriate <code>gips</code> object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2,3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>This is called <code>n0</code> and not
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>œÉ</mi></msub><annotation encoding="application/x-tex">C_\sigma</annotation></semantics></math>
because it is increased by 1 when the mean was estimated:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2,3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-model-selection">Bayesian model selection<a class="anchor" aria-label="anchor" href="#bayesian-model-selection"></a>
</h2>
<p>When one has the data matrix <code>Z</code>, one would like to know
if it has a hidden structure of dependencies between features. Luckily,
the paper demonstrates a way how to find it.</p>
<div class="section level4">
<h4 id="general-workflow">General workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Choose the prior distribution on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.</li>
<li>Calculate the posteriori distribution (up to a normalizing constant)
by the formula <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>,
(30).</li>
<li>Use the Metropolis-Hastings algorithm to find the permutation with
the biggest value of the posterior probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚Ñô</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œì</mi><mo stretchy="false" form="prefix">|</mo><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{P}(\Gamma|Z)</annotation></semantics></math>.</li>
</ol>
</div>
<div class="section level4">
<h4 id="details-on-the-prior-distribution">Details on the prior distribution<a class="anchor" aria-label="anchor" href="#details-on-the-prior-distribution"></a>
</h4>
<p>The considered prior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><msup><mi>Œ£</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K=\Sigma^{-1}</annotation></semantics></math>:</p>
<ol style="list-style-type: decimal">
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
is uniformly distributed on the set of all cyclic subgroups of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùîñ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\mathfrak{S}_p</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
follows the Diaconis-Ylvisaker conjugate prior distribution with
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ¥</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
(real number,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ¥</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\delta &gt; 1</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
(symmetric, positive definite square matrix of the same size as
<code>S</code>), see <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>,
Sec. 3.4.</li>
</ol>
<p>Footnote: Actually, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mi>i</mi><mi>d</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Gamma = \{id\}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ¥</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta &gt; 0</annotation></semantics></math>
parameters are theoretically correct. In <code>gips</code>, we want this
to be defined for all cyclic groups
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œì</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>,
so we restrict
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ¥</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\delta &gt; 1</annotation></semantics></math>.
Refer to the <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>.</p>
</div>
<div class="section level4">
<h4 id="gips-technical-details">
<code>gips</code> technical details<a class="anchor" aria-label="anchor" href="#gips-technical-details"></a>
</h4>
<p>In <code>gips</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ¥</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
is named <code>delta</code>, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
is named <code>D_matrix</code>. By default, they are set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>
and <code>diag(d, p)</code>, respectively, where
<code>d = mean(diag(S))</code>. However, it is worth running the
procedure for several parameters <code>D_matrix</code> of form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>‚ãÖ</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d\cdot diag(p)</annotation></semantics></math>
for positive constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>.
Small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
(compared to the data) favors small structures. Large
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
will ‚Äúforget‚Äù the data.</p>
<p>One can calculate the logarithm of formula (30) with the function
<code><a href="../reference/log_posteriori_of_gips.html">log_posteriori_of_gips()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>When all assumptions are met, the formula (30) puts a number on each
permutation‚Äôs cyclic group. The bigger its value, the more likely the
data was drawn from that model.</p>
<p>When one finds the permutations group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mtext mathvariant="normal">max</mtext></msub><annotation encoding="application/x-tex">c_{\text{max}}</annotation></semantics></math>
that maximizes (30),
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext mathvariant="normal">map</mtext></msub><mo>=</mo><msub><mo>arg‚ÄÜmax</mo><mrow><mi>c</mi><mo>‚àà</mo><msub><mi>ùîñ</mi><mi>p</mi></msub></mrow></msub><mi>‚Ñô</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œì</mi><mo>=</mo><mi>c</mi><mo stretchy="false" form="prefix">|</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_{\text{map}} = \operatorname{arg\,max}_{c\in\mathfrak{S}_p} \mathbb{P}\left(\Gamma=c|Z^{(1)},\ldots,Z^{(n)}\right)</annotation></semantics></math></p>
<p>one can reasonably assume the data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
was drawn from the model
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>œÄ</mi><msub><mi>c</mi><mtext mathvariant="normal">map</mtext></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}_p(0,\pi_{c_{\text{map}}}(S))</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>‚ãÖ</mo><msup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">S = \frac{1}{n} \sum_{i=1}^n Z^{(i)}\cdot {Z^{(i)}}^\top</annotation></semantics></math></p>
<p>In such a case, we call
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mtext mathvariant="normal">map</mtext></msub><annotation encoding="application/x-tex">c_{\text{map}}</annotation></semantics></math>
the Maximum A Posteriori (MAP).</p>
</div>
<div class="section level4">
<h4 id="finding-the-map-estimator">Finding the MAP Estimator<a class="anchor" aria-label="anchor" href="#finding-the-map-estimator"></a>
</h4>
<p>The space of all permutations is enormous for bigger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
(in our experiments,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚â•</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">p\ge 10</annotation></semantics></math>
is too big). In such a big space, estimating the MAP is more reasonable
than calculating it precisely.</p>
<p>Metropolis-Hastings algorithm suggested by the authors of <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a> is a natural way to do
it. To see the discussion on it and other options available in
<code>gips</code>, see
<code><a href="../articles/Optimizers.html">vignette("Optimizers", package="gips")</a></code> or its <a href="https://przechoj.github.io/gips/articles/Optimizers.html">pkgdown
page</a>.</p>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<div id="spoiler3" style="display:none">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare model, multivariate normal distribution</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">p</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span>
<span></span>
<span><span class="co"># Generate example data from a model:</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">2022</span>,</span>
<span>  code <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">number_of_observations</span>,</span>
<span>    mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># End of prepare model</span></span></code></pre></div>
</div>
<button title="Click to show the data preparation" type="button" onclick="if(document.getElementById('spoiler3') .style.display=='none')
              {document.getElementById('spoiler3') .style.display=''}
            else{document.getElementById('spoiler3') .style.display='none'}">
Show/hide data preparation
</button>
<p>Let‚Äôs say we have this data, <code>Z</code>. It has dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">p=6</annotation></semantics></math>
and only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>
observations. Let‚Äôs assume <code>Z</code> was drawn from the normal
distribution with the mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,0,0,0,0,0)</annotation></semantics></math>.
We want to estimate the covariance matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 4</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 6</span></span>
<span></span>
<span><span class="co"># Calculate the covariance matrix from the data (assume the mean is 0):</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span> <span class="op">/</span> <span class="va">number_of_observations</span></span>
<span></span>
<span><span class="co"># Make the gips object out of data:</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; The permutation (1,2,3,4,5,6):</span></span>
<span><span class="co">#&gt;  - was found after 362 posteriori calculations;</span></span>
<span><span class="co">#&gt;  - is 133.158 times more likely than the () permutation.</span></span>
<span></span>
<span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">g_map</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/example2_readme3-1.png" width="700"></p>
<p>We see the posterior probability <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1,(30)]</a> has the biggest
value for the permutation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>6</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,2,3,4,5,6)</annotation></semantics></math>.
It was over 100 times bigger than for the trivial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">id</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚Ä¶</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{id} = (1)(2)\ldots(p)</annotation></semantics></math>
permutation. We interpret that under the assumptions (centered
Gaussian), it is over 100 times more reasonable to assume the data
<code>Z</code> was drawn from model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mtext mathvariant="normal">S_projected</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}_p(0,\text{S_projected})</annotation></semantics></math>
than from model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">N</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mtext mathvariant="normal">S</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{N}_p(0,\text{S})</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="information-criterion---aic-and-bic">Information Criterion - AIC and BIC<a class="anchor" aria-label="anchor" href="#information-criterion---aic-and-bic"></a>
</h2>
<p>One may be interested in Akaike‚Äôs An Information Criterion (AIC) or
Schwarz‚Äôs Bayesian Information Criterion (BIC) of the found model. Those
are defined based on log-Likelihood:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ£</mi><mo>;</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mfrac><mi>p</mi><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>œÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mi>‚ä§</mi></msup><msup><mi>Œ£</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">\log L\left(\Sigma; Z^{(1)},\ldots,Z^{(n)}\right) = \sum_{i=1}^n \left(- \frac{p}{2}\log (2\pi) - \frac{1}{2}\log\left( \det\left( \Sigma\right)\right) - \frac12 {Z^{(i)}}^\top \Sigma^{-1} Z^{(i)}\right)= </annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mfrac><mrow><mi>n</mi><mi>p</mi></mrow><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>œÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Œ£</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">- \frac{np}{2}\log (2\pi) - \frac{n}{2}\log\left( \det\left( \Sigma\right)\right) - \frac{n}2\mathrm{tr}(\Sigma^{-1} S),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>‚ãÖ</mo><msup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">S = \frac{1}{n} \sum_{i=1}^n Z^{(i)}\cdot {Z^{(i)}}^\top</annotation></semantics></math>.</p>
<p>The MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
in a model invariant under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œì</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\Gamma=c</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Œ£</mi><mo accent="true">ÃÇ</mo></mover><mo>=</mo><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\Sigma} = \pi_{c}(S)</annotation></semantics></math>.
Further, for every
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÄ</mi><mi>c</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚ãÖ</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">\mathrm{tr}(\pi_{c}(S)^{-1} \cdot S) = p</annotation></semantics></math>,
so:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>;</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>‚àí</mo><mfrac><mrow><mi>n</mi><mi>p</mi></mrow><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>œÄ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>det</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mrow><mi>n</mi><mi>p</mi></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\log L\left(\pi_{c}(S); Z^{(1)},\ldots,Z^{(n)}\right) = - \frac{np}{2}\log (2\pi) - \frac{n}{2}\log\left( \det\left( \pi_{c}(S)\right)\right) - \frac{np}2</annotation></semantics></math></p>
<p>which can be calculated by <code><a href="../reference/logLik.gips.html">logLik.gips()</a></code>.</p>
<p>Then AIC and BIC are defined by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>I</mi><mi>C</mi><mo>=</mo><mn>2</mn><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>dim</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>2</mn><mo>log</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">AIC = 2 \cdot (\dim M) -2 \log L(\pi_{c}(S))</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><mi>C</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>dim</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>2</mn><mo>log</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÄ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">BIC = (\log n) \cdot (\dim M) -2 \log L(\pi_{c}(S))</annotation></semantics></math></p>
<p>A smaller value of the criteria for a given model indicates a better
fit.</p>
<p>Those can be calculated by <code><a href="../reference/AIC.gips.html">AIC.gips()</a></code> and
<code><a href="../reference/AIC.gips.html">BIC.gips()</a></code>.</p>
<div class="section level4">
<h4 id="estimated-mean">Estimated mean<a class="anchor" aria-label="anchor" href="#estimated-mean"></a>
</h4>
<p>When the mean was estimated, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>‚àí</mo><mover><mi>Z</mi><mo accent="true">‚Äæ</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mo stretchy="false" form="prefix">(</mo><msup><mrow><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>‚àí</mo><mover><mi>Z</mi><mo accent="true">‚Äæ</mo></mover><mo stretchy="false" form="postfix">)</mo></mrow><mi>‚ä§</mi></msup></mrow><annotation encoding="application/x-tex">S = \frac{1}{n-1} \sum_{i=1}^n (Z^{(i)} - \bar{Z})\cdot ({Z^{(i)} - \bar{Z})}^\top</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Z</mi><mo accent="true">‚Äæ</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Z} = \frac{1}{n} \sum_{i=1}^n Z^{(i)}</annotation></semantics></math>.
Then in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">\log L</annotation></semantics></math>
we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math>
in stead of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>.
Definitions of AIC and BIC stay the same.</p>
</div>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>Consider an example similar to one in the <strong>Bayesian model
selection</strong> section:</p>
<div id="spoiler4" style="display:none">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare model, multivariate normal distribution</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">p</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span>
<span></span>
<span><span class="co"># Generate example data from a model:</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">2022</span>,</span>
<span>  code <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">number_of_observations</span>,</span>
<span>    mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># End of prepare model</span></span></code></pre></div>
</div>
<button title="Click to show the data preparation" type="button" onclick="if(document.getElementById('spoiler4') .style.display=='none')
              {document.getElementById('spoiler4') .style.display=''}
            else{document.getElementById('spoiler4') .style.display='none'}">
Show/hide data preparation
</button>
<p>Let‚Äôs say we have this data, <code>Z</code>. It has dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">p=6</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7</mn><annotation encoding="application/x-tex">7</annotation></semantics></math>
observations. Let‚Äôs assume <code>Z</code> was drawn from the normal
distribution with the mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,0,0,0,0,0)</annotation></semantics></math>.
We want to estimate the covariance matrix:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7 6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 7</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 6</span></span>
<span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span> <span class="op">/</span> <span class="va">number_of_observations</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 64.19906</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span> <span class="co"># this is smaller, so this is better</span></span>
<span><span class="co">#&gt; [1] 62.99751</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 63.06318</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span> <span class="co"># this is smaller, so this is better</span></span>
<span><span class="co">#&gt; [1] 62.78115</span></span></code></pre></div>
<p>We will consider a <code>g_map</code> better model both in terms of
the AIC and the BIC.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>[1] Piotr Graczyk, Hideyuki Ishi, Bartosz Ko≈Çodziejek, H√©l√®ne Massam.
‚ÄúModel selection in the space of Gaussian models invariant by symmetry.‚Äù
The Annals of Statistics, 50(3) 1747-1774 June 2022. <a href="https://arxiv.org/abs/2004.03503" class="external-link">arXiv link</a>; <a href="https://doi.org/10.1214/22-AOS2174" class="external-link">DOI:
10.1214/22-AOS2174</a></p>
<p>[2] ‚ÄúLearning permutation symmetries with gips in R‚Äù by
<code>gips</code> developers Adam Chojecki, Pawe≈Ç Morgen, and Bartosz
Ko≈Çodziejek, <a href="doi:10.18637/jss.v112.i07">Journal of Statistical
Software</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Przemys≈Çaw Chojecki, Pawe≈Ç Morgen, Bartosz Ko≈Çodziejek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
