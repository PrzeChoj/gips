<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gips">
<title>Theory • gips</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Theory">
<meta property="og:description" content="gips">
<meta property="og:image" content="https://przechoj.github.io/gips/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gips</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/gips.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Optimizers.html">Optimizers</a>
    <a class="dropdown-item" href="../articles/Theory.html">Theory</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PrzeChoj/gips/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Theory</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PrzeChoj/gips/blob/HEAD/vignettes/Theory.Rmd" class="external-link"><code>vignettes/Theory.Rmd</code></a></small>
      <div class="d-none name"><code>Theory.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="theory-the-gips-is-based-on">Theory the <code>gips</code> is based on<a class="anchor" aria-label="anchor" href="#theory-the-gips-is-based-on"></a>
</h2>
<p>The package is based on the article <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>. There the math behind
the package is precisely demonstrated, and all the theorems are
proven.</p>
<p>In this vignette, we would like to give a gentle introduction. We
want to point out all the most important results from this work from the
user’s point of view. We will also show examples of those results in the
<code>gips</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PrzeChoj/gips" class="external-link">gips</a></span><span class="op">)</span></span></code></pre></div>
<p>As mentioned in the abstract, the outline of the paper is to “derive
the distribution of the maximum likelihood estimate of the covariance
parameter <span class="math inline">\(\Sigma\)</span> (…)” and then to
“perform Bayesian model selection in the class of complete Gaussian
models invariant by the action of a subgroup of the symmetric group
(…)”. Those ideas are implemented in the <code>gips</code> package.</p>
</div>
<div class="section level2">
<h2 id="basic-definitions">Basic definitions<a class="anchor" aria-label="anchor" href="#basic-definitions"></a>
</h2>
<p>Let <span class="math inline">\(V=\{1,\ldots,p\}\)</span> be a finite
index set, and for every <span class="math inline">\(i\in \{1, \dots,
n\}\)</span>, <span class="math inline">\(Z^{(i)}=(Z_1^{(i)},\ldots,
Z_p^{(i)})^\top\)</span> be a multivariate random variable following a
centered Gaussian model <span class="math inline">\(\mathrm{N}_p(0,\Sigma)\)</span>, and let <span class="math inline">\(Z^{(1)},\ldots, Z^{(n)}\)</span> be an i.i.d.
(independent and identically distributed) sample from this distribution.
Name the whole sample <span class="math inline">\(Z = (Z^{(1)},\ldots,
Z^{(n)})\)</span>.</p>
<p>Let <span class="math inline">\(\mathfrak{S}_p\)</span> denote the
symmetric group on <span class="math inline">\(V\)</span>, that is, the
set of all permutations on <span class="math inline">\(\{1,\ldots,p\}\)</span> with function composition
as the group operation. Let <span class="math inline">\(\Gamma\)</span>
be an arbitrary subgroup of <span class="math inline">\(\mathfrak{S}_p\)</span>. The model <span class="math inline">\(\mathrm{N}_p(0,\Sigma)\)</span> is said to be
invariant under the action of <span class="math inline">\(\Gamma\)</span> if for all <span class="math inline">\(g\in \Gamma\)</span>, <span class="math inline">\(g\cdot\Sigma\cdot g^\top=\Sigma\)</span> (here, we
identify a permutation <span class="math inline">\(g\)</span> with its
permutation matrix).</p>
<p>For a subgroup <span class="math inline">\(\Gamma \subset
\mathfrak{S}_p\)</span>, we define the colored space, i.e. the space of
symmetric matrices invariant under <span class="math inline">\(\Gamma\)</span>, <span class="math display">\[\mathcal{Z}_{\Gamma} := \{S \in
\mathrm{Sym}(p;\mathbb{R})\colon S_{i,j} = S_{\sigma(i),\sigma(j)}
\text{ for all }\sigma \in \Gamma\mbox{ for all }i,j\in V\},\]</span>
and the colored cone of positive definite matrices valued in <span class="math inline">\(\mathcal{Z}_{\Gamma}\)</span>, <span class="math display">\[\mathcal{P}_{\Gamma} := \mathcal{Z}_{\Gamma} \cap
\mathrm{Sym}^+(p;\mathbb{R}).\]</span></p>
</div>
<div class="section level2">
<h2 id="block-decomposition---1-theorem-1">Block Decomposition - [1], Theorem 1<a class="anchor" aria-label="anchor" href="#block-decomposition---1-theorem-1"></a>
</h2>
<p>The main theoretical result in this theory (Theorem 1 in <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>) states that given a
permutation subgroup <span class="math inline">\(\Gamma\)</span> there
exists an orthogonal matrix <span class="math inline">\(U_\Gamma\)</span> such that all the symmetric
matrices <span class="math inline">\(S\in\mathcal{Z}_\Gamma\)</span> can
be transformed into block-diagonal form.</p>
<p>The exact form of blocks depends on so-called <em>structure
constants</em> <span class="math inline">\((k_i,d_i,r_i)_{i=1}^L\)</span>. It is worth
pointing out that constants <span class="math inline">\(k = d\)</span>
for cyclic group <span class="math inline">\(\Gamma =
\left&lt;\sigma\right&gt;\)</span> and that <code>gips</code> searches
within cyclic subgroups only.</p>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,</span>
<span>              <span class="fl">0.9</span>,<span class="fl">1.1</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,</span>
<span>              <span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">1.1</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,</span>
<span>              <span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">1.1</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,</span>
<span>              <span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">1.1</span>,<span class="fl">0.9</span>,</span>
<span>              <span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">1.1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_2-1.png" width="700"></p>
<p><code>S</code> is a symmetric matrix invariant under the group <span class="math inline">\(\Gamma =
\left&lt;(1,2,3,4,5,6)\right&gt;\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips_perm.html">gips_perm</a></span><span class="op">(</span><span class="st">"(1,2,3,4,5,6)"</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">U_Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_orthogonal_matrix.html">prepare_orthogonal_matrix</a></span><span class="op">(</span><span class="va">g_perm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">block_decomposition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">U_Gamma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">U_Gamma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">block_decomposition</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]  5.2  0.0  0.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [2,]  0.0  0.5  0.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [3,]  0.0  0.0  0.5  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [4,]  0.0  0.0  0.0  0.1  0.0  0.0</span></span>
<span><span class="co">#&gt; [5,]  0.0  0.0  0.0  0.0  0.1  0.0</span></span>
<span><span class="co">#&gt; [6,]  0.0  0.0  0.0  0.0  0.0  0.2</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_4-1.png" width="700"></p>
<p>The transformed matrix is in the block-diagonal form of <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>, Theorem 1. Blank
entries are off-block entries and equal to 0. Notice that, for example,
the [2,3] is not blank regardless of being 0. This is because it is a
part of the block-diagonal form but happens to have a value of 0.</p>
<p>The result was rounded to the 5th place after the decimal to hide the
inaccuracies of floating point arithmetic.</p>
<p>Let’s see the other example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,</span>
<span>              <span class="fl">0.9</span>,<span class="fl">1.2</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>,</span>
<span>              <span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1.2</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>,</span>
<span>              <span class="fl">0.4</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">1.2</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,</span>
<span>              <span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">1.2</span>,<span class="fl">0.9</span>,</span>
<span>              <span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">1.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_6-1.png" width="700"></p>
<p>Now, <code>S</code> is a symmetric matrix invariant under the group
<span class="math inline">\(\Gamma =
\left&lt;(1,2,3)(4,5,6)\right&gt;\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_perm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips_perm.html">gips_perm</a></span><span class="op">(</span><span class="st">"(1,2,3)(4,5,6)"</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">U_Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_orthogonal_matrix.html">prepare_orthogonal_matrix</a></span><span class="op">(</span><span class="va">g_perm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">block_decomposition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">U_Gamma</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">U_Gamma</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">block_decomposition</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]   [,3]    [,4]    [,5]   [,6]</span></span>
<span><span class="co">#&gt; [1,]  3.0  0.7 0.0000  0.0000  0.0000 0.0000</span></span>
<span><span class="co">#&gt; [2,]  0.7  3.0 0.0000  0.0000  0.0000 0.0000</span></span>
<span><span class="co">#&gt; [3,]  0.0  0.0 0.3000  0.0000  0.2500 0.0866</span></span>
<span><span class="co">#&gt; [4,]  0.0  0.0 0.0000  0.3000 -0.0866 0.2500</span></span>
<span><span class="co">#&gt; [5,]  0.0  0.0 0.2500 -0.0866  0.3000 0.0000</span></span>
<span><span class="co">#&gt; [6,]  0.0  0.0 0.0866  0.2500  0.0000 0.3000</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/th1_8-1.png" width="700"></p>
<p>Again, this result is in accordance with <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>, Theorem 1. Notice the
zeros in <code>block_decomposition</code>: <span class="math display">\[\forall_{i\in\{1,2\},j\in\{3,4,5,6\}}\text{block_decomposition}[i,j]
= 0\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="project-matrix---1-eq--6">Project Matrix - [1, Eq. (6)]<a class="anchor" aria-label="anchor" href="#project-matrix---1-eq--6"></a>
</h2>
<p>One can also take any symmetric square matrix <code>S</code> and find
the orthogonal projection on <span class="math inline">\(\mathcal{Z}_{\Gamma}\)</span>, the space of
matrices invariant under the given permutation:</p>
<p><span class="math display">\[\pi_\Gamma(S) :=
\frac{1}{|\Gamma|}\sum_{\sigma\in\Gamma}\sigma\cdot
S\cdot\sigma^\top\]</span></p>
<p>The projected matrix is the element of the cone <span class="math inline">\(\pi_\Gamma(S)\in\mathcal{Z}_{\Gamma}\)</span>,
which means: <span class="math display">\[\forall_{i,j\in \{1,\ \dots,\
p\}} \pi_\Gamma(S)[i,j] = \pi_\Gamma(S)[\sigma(i),\sigma(j)] \text{ for
all }\sigma\in\Gamma\]</span></p>
<p>So it has some identical elements.</p>
<div class="section level4">
<h4 id="trivial-case">Trivial case<a class="anchor" aria-label="anchor" href="#trivial-case"></a>
</h4>
<p>Note that for <span class="math inline">\(\Gamma = \{\text{id}\} =
\{(1)(2)\dots(p)\}\)</span> we have <span class="math inline">\(\pi_{\{\text{id}\}}(S) = S\)</span>.</p>
<p>So, no additional assumptions are made; thus the standard covariance
estimator is the best we can do.</p>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>Let <code>S</code> be any symmetric square matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]   [,3]   [,4]   [,5]   [,6]</span></span>
<span><span class="co">#&gt; [1,] 137.51 -16.21  10.03   0.16 -24.35 -17.42</span></span>
<span><span class="co">#&gt; [2,] -16.21  34.08 -10.62  15.93  12.23  -2.74</span></span>
<span><span class="co">#&gt; [3,]  10.03 -10.62  35.47   3.10  -3.81  -9.60</span></span>
<span><span class="co">#&gt; [4,]   0.16  15.93   3.10  26.74   7.71 -13.51</span></span>
<span><span class="co">#&gt; [5,] -24.35  12.23  -3.81   7.71  26.00  -7.24</span></span>
<span><span class="co">#&gt; [6,] -17.42  -2.74  -9.60 -13.51  -7.24  16.77</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/def3_2-1.png" width="700"></p>
<p>One can project this matrix, for example, on <span class="math inline">\(\Gamma =
\left&lt;(1,2)(3,4,5,6)\right&gt;\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S_projected</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]   [,2]  [,3]  [,4]  [,5]  [,6]</span></span>
<span><span class="co">#&gt; [1,]  85.80 -16.21 -0.28 -3.91 -0.28 -3.91</span></span>
<span><span class="co">#&gt; [2,] -16.21  85.80 -3.91 -0.28 -3.91 -0.28</span></span>
<span><span class="co">#&gt; [3,]  -0.28  -3.91 26.25 -1.51 -8.66 -1.51</span></span>
<span><span class="co">#&gt; [4,]  -3.91  -0.28 -1.51 26.25 -1.51 -8.66</span></span>
<span><span class="co">#&gt; [5,]  -0.28  -3.91 -8.66 -1.51 26.25 -1.51</span></span>
<span><span class="co">#&gt; [6,]  -3.91  -0.28 -1.51 -8.66 -1.51 26.25</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/def3_4-1.png" width="700"></p>
<p>Notice in the <code>S_projected</code> matrix, there are identical
elements according to the equation from the beginning of this section.
For example, <code>S_projected[1,1] = S_projected[2,2]</code>.</p>
</div>
<div class="section level3">
<h3 id="c_sigma-and-n0">
<span class="math inline">\(C_\sigma\)</span> and
<code>n0</code><a class="anchor" aria-label="anchor" href="#c_sigma-and-n0"></a>
</h3>
<p>It is a well-known fact that without additional assumptions, the
Maximum Likelihood Estimator (MLE) of the covariance matrix in the
Gaussian model exists if and only if <span class="math inline">\(n \ge
p\)</span>. However, if the additional assumption is added as the
covariance matrix is invariant under permutation <span class="math inline">\(\sigma\)</span>, then the sample size <span class="math inline">\(n\)</span> required for the MLE to exist is lower
than <span class="math inline">\(p\)</span>. It is equal to the number
of cycles, denoted hereafter by <span class="math inline">\(C_\sigma\)</span>.</p>
<p>For example, if the permutation <span class="math inline">\(\sigma =
(1,2,3,4,5,6)\)</span> is discovered by the <code><a href="../reference/find_MAP.html">find_MAP()</a></code>
function, then there is a single cycle in it <span class="math inline">\(C_\sigma = 1\)</span>. Therefore a single
observation would be enough to estimate a covariance matrix with
<code><a href="../reference/project_matrix.html">project_matrix()</a></code>. If the permutation <span class="math inline">\(\sigma = (1,2)(3,4,5,6)\)</span> is discovered,
then <span class="math inline">\(C_\sigma = 2\)</span> and so 2
observations would be enough.</p>
<p>To get this <span class="math inline">\(C_\sigma\)</span> number in
<code>gips</code>, one can call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on the
appropriate <code>gips</code> object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2,3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>This is called <code>n0</code> and not <span class="math inline">\(C_\sigma\)</span>, because it is increased by 1
when the mean was estimated:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2,3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">n</span>, perm <span class="op">=</span> <span class="st">"(1,2)(3,4,5,6)"</span>, was_mean_estimated <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-model-selection">Bayesian model selection<a class="anchor" aria-label="anchor" href="#bayesian-model-selection"></a>
</h2>
<p>When one has the data matrix <code>Z</code>, one would like to know
if it has a hidden structure of dependencies between features. Luckily,
the paper demonstrates a way how to find it.</p>
<div class="section level4">
<h4 id="general-workflow">General workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Choose the prior distribution on <span class="math inline">\(\Gamma\)</span> and <span class="math inline">\(\Sigma\)</span>.</li>
<li>Calculate the posteriori distribution (up to a normalizing constant)
by formula <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>,
(30).</li>
<li>Use the Metropolis-Hastings algorithm to find the permutation with
the biggest value of the posterior probability <span class="math inline">\(\mathbb{P}(\Gamma|Z)\)</span>.</li>
</ol>
</div>
<div class="section level4">
<h4 id="details-on-the-prior-distribution">Details on the prior distribution<a class="anchor" aria-label="anchor" href="#details-on-the-prior-distribution"></a>
</h4>
<p>The considered prior distribution of <span class="math inline">\(\Gamma\)</span> and <span class="math inline">\(K=\Sigma^{-1}\)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\Gamma\)</span> is uniformly distributed
on the set of all cyclic subgroups of <span class="math inline">\(\mathfrak{S}_p\)</span>.</li>
<li>
<span class="math inline">\(K\)</span> given <span class="math inline">\(\Gamma\)</span> follows the Diaconis-Ylvisaker
conjugate prior distribution with parameters <span class="math inline">\(\delta\)</span> (real number, <span class="math inline">\(\delta &gt; 1\)</span>) and <span class="math inline">\(D\)</span> (symmetric, positive definite square
matrix of the same size as <code>S</code>), see <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>, Sec. 3.4.</li>
</ol>
<p>Footnote: Actually, for <span class="math inline">\(\Gamma =
\{id\}\)</span>, <span class="math inline">\(\delta &gt; 0\)</span>
parameter are theoretically correct. In <code>gips</code> we want this
to be defined for all cyclic groups <span class="math inline">\(\Gamma\)</span>, so we restrict <span class="math inline">\(\delta &gt; 1\)</span>. Refer to the <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a>.</p>
</div>
<div class="section level4">
<h4 id="gips-technical-details">
<code>gips</code> technical details<a class="anchor" aria-label="anchor" href="#gips-technical-details"></a>
</h4>
<p>In <code>gips</code>, <span class="math inline">\(\delta\)</span> is
named <code>delta</code>, and <span class="math inline">\(D\)</span> is
named <code>D_matrix</code>. By default, they are set to <span class="math inline">\(3\)</span> and <code>diag(p)</code>, respectively.
However, it is worth running the procedure for several parameters
<code>D_matrix</code> of form <span class="math inline">\(d\cdot
diag(p)\)</span> for positive constant <span class="math inline">\(d\)</span>. Large <span class="math inline">\(d\)</span> (compared to the data) favors small
structures.</p>
<p>One can calculate the logarithm of formula (30) with function
<code><a href="../reference/log_posteriori_of_gips.html">log_posteriori_of_gips()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>When all assumptions are met, the formula (30) puts a number on each
permutation’s cyclic group. The bigger its value, the more likely the
data was drawn from that model.</p>
<p>When one finds the permutations group <span class="math inline">\(c_{\text{max}}\)</span> that maximizes (30), <span class="math display">\[c_{\text{map}} =
\operatorname{arg\,max}_{c\in\mathfrak{S}_p}
\mathbb{P}\left(\Gamma=c|Z^{(1)},\ldots,Z^{(n)}\right)\]</span></p>
<p>one can reasonably assume the data <span class="math inline">\(Z\)</span> was drawn from the model <span class="math display">\[\mathrm{N}_p(0,\pi_{c_{\text{map}}}(S))\]</span></p>
<p>where <span class="math inline">\(S = \frac{1}{n} \sum_{i=1}^n
Z^{(i)}\cdot {Z^{(i)}}^\top\)</span></p>
<p>In such a case, we call <span class="math inline">\(c_{\text{map}}\)</span> the Maximum A Posteri
(MAP).</p>
</div>
<div class="section level4">
<h4 id="finding-the-map-estimator">Finding the MAP Estimator<a class="anchor" aria-label="anchor" href="#finding-the-map-estimator"></a>
</h4>
<p>The space of all permutations is enormous for bigger <span class="math inline">\(p\)</span> (in our experiments, <span class="math inline">\(p\ge 9\)</span> is too big). In such a big space,
it is more reasonable to estimate the MAP than to calculate it
precisely.</p>
<p>Metropolis-Hastings algorithm suggested by the authors of <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1]</a> is a natural way to do
it. To see the discussion on it and other options available in
<code>gips</code>, see
<code><a href="../articles/Optimizers.html">vignette("Optimizers", package="gips")</a></code> or its <a href="https://przechoj.github.io/gips/articles/Optimizers.html">pkgdown
page</a>.</p>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<div id="spoiler3" style="display:none">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare model, multivariate normal distribution</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">p</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span>
<span></span>
<span><span class="co"># Generate example data from a model:</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">2022</span>,</span>
<span>  code <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">number_of_observations</span>,</span>
<span>                       mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># End of prepare model</span></span></code></pre></div>
</div>
<button title="Click to show the data preparation" type="button" onclick="if(document.getElementById('spoiler3') .style.display=='none')
              {document.getElementById('spoiler3') .style.display=''}
            else{document.getElementById('spoiler3') .style.display='none'}">
Show/hide data preparation
</button>
<p>Let’s say we have this data, <code>Z</code>. It has only <span class="math inline">\(4\)</span> observations, and its dimension is
<span class="math inline">\(p=6\)</span>. Let’s assume <code>Z</code>
was drawn from the normal distribution with the mean <span class="math inline">\((0,0,0,0,0,0)\)</span>. We want to estimate the
covariance matrix:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 4</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 6</span></span>
<span></span>
<span><span class="co"># Calculate the covariance matrix from the data (assume the mean is 0):</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span> <span class="op">/</span> <span class="va">number_of_observations</span></span>
<span></span>
<span><span class="co"># Make the gips object out of data:</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; The permutation (1,2,3,4,5,6):</span></span>
<span><span class="co">#&gt;  - was found after 720 posteriori calculations;</span></span>
<span><span class="co">#&gt;  - is 513.723 times more likely than the starting, () permutation.</span></span>
<span></span>
<span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">g_map</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="Theory_files/figure-html/example2_readme3-1.png" width="700"></p>
<p>We see the posterior probability <a href="https://arxiv.org/abs/2004.03503" class="external-link">[1,(30)]</a> has the biggest
value for the permutation <span class="math inline">\((1,2,3,4,5,6)\)</span>. It was over 500 times
bigger than for the trivial <span class="math inline">\(\text{id} =
(1)(2)\ldots(p)\)</span> permutation. We interpret that under the
assumptions (centered Gaussian), it is over 500 times more reasonable to
assume the data <code>Z</code> was drawn from model <span class="math inline">\(\mathrm{N}_p(0,\text{S_projected})\)</span> than
from model <span class="math inline">\(\mathrm{N}_p(0,\text{S})\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="information-criterion---aic-and-bic">Information Criterion - AIC and BIC<a class="anchor" aria-label="anchor" href="#information-criterion---aic-and-bic"></a>
</h2>
<p>One may be interested in Akaike’s An Information Criterion (AIC) or
Schwarz’s Bayesian Information Criterion (BIC) of the found model. Those
are defined as follows:</p>
<p><span class="math display">\[\log L\left(\hat{K};
Z^{(1)},\ldots,Z^{(n)}\right) = \sum_{i=1}^n \left(- \frac{p}{2}\log
(2\pi) - \frac{1}{2}\log\left( \det\left( \hat{K}\right)\right) -
\frac12 {Z^{(i)}}^\top \hat{K}^{-1} Z^{(i)}\right)= \]</span></p>
<p><span class="math display">\[- \frac{np}{2}\log (2\pi) -
\frac{n}{2}\log\left( \det\left( \hat{K}\right)\right) -
\frac{n}2\mathrm{tr}(\hat{K}^{-1} S),\]</span> where <span class="math inline">\(S = \frac{1}{n} \sum_{i=1}^n Z^{(i)}\cdot
{Z^{(i)}}^\top\)</span>.</p>
<p>Further, for every <span class="math inline">\(c\)</span> we have
<span class="math inline">\(\mathrm{tr}(\pi_{c}(S)^{-1} \cdot S) =
p\)</span>, so:</p>
<p><span class="math display">\[\log L\left(\pi_{c}(S);
Z^{(1)},\ldots,Z^{(n)}\right) = - \frac{np}{2}\log (2\pi) -
\frac{n}{2}\log\left( \det\left( \pi_{c}(S)\right)\right) -
\frac{np}2\]</span></p>
<p>Which can be calculated by <code><a href="../reference/logLik.gips.html">logLik.gips()</a></code>.</p>
<p>Then AIC and BIC are defined by:</p>
<p><span class="math display">\[AIC = 2 \cdot (\dim M) -2 \log L(\hat
K)\]</span> <span class="math display">\[BIC = (\log n) \cdot (\dim M)
-2 \log L(\hat K)\]</span></p>
<p>The interpretation is as follows: the smaller the criterion, the
better the model.</p>
<p>Those can be calculated by <code><a href="../reference/AIC.gips.html">AIC.gips()</a></code> and
<code><a href="../reference/AIC.gips.html">BIC.gips()</a></code>.</p>
<div class="section level4">
<h4 id="estimated-mean">Estimated mean<a class="anchor" aria-label="anchor" href="#estimated-mean"></a>
</h4>
<p>When the mean was estimated, we have <span class="math inline">\(S =
\frac{1}{n-1} \sum_{i=1}^n (Z^{(i)} - \bar{Z})\cdot ({Z^{(i)} -
\bar{Z})}^\top\)</span>, where <span class="math inline">\(\bar{Z} =
\frac{1}{n} \sum_{i=1}^n Z^{(i)}\)</span>. Then:</p>
<p><span class="math display">\[\log L_{estimated\
mean}\left(\pi_{c}(S); Z^{(1)},\ldots,Z^{(n)}\right) = -
\frac{(n-1)\cdot p}{2}\log (2\pi) - \frac{(n-1)}{2}\log\left( \det\left(
\pi_{c}(S)\right)\right) - \frac{(n-1)\cdot p}2\]</span></p>
<p>And definitions of AIC and BIC stay the same:</p>
<p><span class="math display">\[AIC = 2 \cdot (\dim M) -2 \log
L_{estimated\ mean}(\hat K)\]</span> <span class="math display">\[BIC =
(\log n) \cdot (\dim M) -2 \log L_{estimated\ mean}(\hat K)\]</span></p>
</div>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>Consider example similar to one in <strong>Bayesian model
selection</strong> section:</p>
<div id="spoiler4" style="display:none">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare model, multivariate normal distribution</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.05</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">p</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span>
<span></span>
<span><span class="co"># Generate example data from a model:</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">2022</span>,</span>
<span>  code <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">number_of_observations</span>,</span>
<span>                       mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># End of prepare model</span></span></code></pre></div>
</div>
<button title="Click to show the data preparation" type="button" onclick="if(document.getElementById('spoiler4') .style.display=='none')
              {document.getElementById('spoiler4') .style.display=''}
            else{document.getElementById('spoiler4') .style.display='none'}">
Show/hide data preparation
</button>
<p>Let’s say we have this data, <code>Z</code>. It has <span class="math inline">\(7\)</span> observations, and its dimension is
<span class="math inline">\(p=6\)</span>. Let’s assume <code>Z</code>
was drawn from the normal distribution with the mean <span class="math inline">\((0,0,0,0,0,0)\)</span>. We want to estimate the
covariance matrix:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7 6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 7</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 6</span></span>
<span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span> <span class="op">/</span> <span class="va">number_of_observations</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 64.19906</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span> <span class="co"># this is smaller, so this is better</span></span>
<span><span class="co">#&gt; [1] 62.99751</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 63.06318</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span> <span class="co"># this is smaller, so this is better</span></span>
<span><span class="co">#&gt; [1] 62.78115</span></span></code></pre></div>
<p>We will consider <code>g_map</code> better model both in terms of the
AIC and the BIC.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>[1] Piotr Graczyk, Hideyuki Ishi, Bartosz Kołodziejek, Hélène Massam.
“Model selection in the space of Gaussian models invariant by symmetry.”
The Annals of Statistics, 50(3) 1747-1774 June 2022. <a href="https://arxiv.org/abs/2004.03503" class="external-link">arXiv link</a>; <a href="https://doi.org/10.1214/22-AOS2174" class="external-link">DOI:
10.1214/22-AOS2174</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Adam Przemysław Chojecki, Paweł Morgen, Bartosz Kołodziejek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
