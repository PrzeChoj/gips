<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Find the permutation symmetry group such that the covariance
    matrix of the given data is approximately invariant under it.
    Discovering such a permutation decreases the number of observations
    needed to fit a Gaussian model, which is of great use when it is
    smaller than the number of variables. Even if that is not the case,
    the covariance matrix found with gips approximates the actual
    covariance with less statistical error. The methods implemented in
    this package are described in Graczyk et al. (2022)
    &lt;doi:10.1214/22-AOS2174&gt;.">
<title>Gaussian Model Invariant by Permutation Symmetry • gips</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Gaussian Model Invariant by Permutation Symmetry">
<meta property="og:description" content="Find the permutation symmetry group such that the covariance
    matrix of the given data is approximately invariant under it.
    Discovering such a permutation decreases the number of observations
    needed to fit a Gaussian model, which is of great use when it is
    smaller than the number of variables. Even if that is not the case,
    the covariance matrix found with gips approximates the actual
    covariance with less statistical error. The methods implemented in
    this package are described in Graczyk et al. (2022)
    &lt;doi:10.1214/22-AOS2174&gt;.">
<meta property="og:image" content="https://przechoj.github.io/gips/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">gips</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/gips.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Optimizers.html">Optimizers</a>
    <a class="dropdown-item" href="articles/Theory.html">Theory</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PrzeChoj/gips/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="gips-">
<code>gips</code> 
<a class="anchor" aria-label="anchor" href="#gips-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end -->
<p>gips - Gaussian model Invariant by Permutation Symmetry</p>
<p><code>gips</code> is an R package that looks for permutation symmetries in the multivariate Gaussian sample. Such symmetries reduce the free parameters in the unknown covariance matrix. This is especially useful when the number of variables is substantially larger than the number of observations.</p>
<div class="section level2">
<h2 id="gips-will-help-you-with-two-things">
<code>gips</code> will help you with two things:<a class="anchor" aria-label="anchor" href="#gips-will-help-you-with-two-things"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Finding hidden symmetries between the variables. <code>gips</code> can be used as an exploratory tool for searching the space of permutation symmetries of the Gaussian vector. Useful in the Exploratory Data Analysis (EDA).</li>
<li>Covariance estimation. The Maximum Likelihood Estimator (MLE) for the covariance matrix is known to exist if and only if the number of variables is less or equal to the number of observations. Additional knowledge of symmetries significantly weakens this requirement. Moreover, the reduction of model dimension brings the advantage in terms of precision of covariance estimation.</li>
</ol>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>From <a href="https://CRAN.R-project.org/package=gips" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the released version from CRAN:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"gips"</span><span class="op">)</span></span></code></pre></div>
<p>From <a href="https://github.com/PrzeChoj/gips" class="external-link">GitHub</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the development version from GitHub:</span></span>
<span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"PrzeChoj/gips"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1---eda">Example 1 - EDA<a class="anchor" aria-label="anchor" href="#example-1---eda"></a>
</h3>
<p>Assume we have the data, and we want to understand its structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PrzeChoj/gips" class="external-link">gips</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">HSAUR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/HSAUR/man/aspirin.html" class="external-link">aspirin</a></span></span>
<span></span>
<span><span class="co"># Renumber the columns for better readability:</span></span>
<span><span class="va">Z</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Assume the data <code>Z</code> is normally distributed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7 4</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 7</span></span>
<span><span class="va">perm_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 4</span></span>
<span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]    [,2]    [,3]    [,4]</span></span>
<span><span class="co">#&gt; [1,]  381405  345527 1864563 1813725</span></span>
<span><span class="co">#&gt; [2,]  345527  316411 1711853 1663065</span></span>
<span><span class="co">#&gt; [3,] 1864563 1711853 9305049 8991343</span></span>
<span><span class="co">#&gt; [4,] 1813725 1663065 8991343 8755176</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span><span class="op">)</span></span>
<span><span class="fu">my_add_text</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>, type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_mean_unknown2-1.png" width="100%"></p>
<p>Remember, we analyze the covariance matrix. We can see some strong similarities between the covariances of columns 3 and 4. Those have similar variances (<code>S[3,3]</code> <span class="math inline">≈</span> <code>S[4,4]</code>), and their covariances with the rest of the columns are alike (<code>S[1,3]</code> <span class="math inline">≈</span> <code>S[1,4]</code> and <code>S[2,3]</code> <span class="math inline">≈</span> <code>S[2,4]</code>).</p>
<p>Note that the variances of columns 1 and 2 are also similar, but the covariances with other columns (3 and 4) are not alike.</p>
<p>Let’s see if the <code><a href="reference/find_MAP.html">find_MAP()</a></code> will find this relationship:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_MAP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span></span>
<span><span class="va">g_MAP</span></span>
<span><span class="co">#&gt; The permutation (3,4)</span></span>
<span><span class="co">#&gt;  - was found after 24 log_posteriori calculations</span></span>
<span><span class="co">#&gt;  - is 1.062e+14 times more likely than the starting, () permutation.</span></span></code></pre></div>
<p>The <code>find_MAP</code> found the relationship (3,4). In its opinion, the variances [3,3] and [4,4] are so close to each other that it is reasonable to consider them equal. Similarly, the covariances [1,3] and [1,4]; just as covariances [2,3] and [3,4], also will be considered equal:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">g_MAP</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">S_projected</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]    [,2]    [,3]    [,4]</span></span>
<span><span class="co">#&gt; [1,]  381405  345527 1839144 1839144</span></span>
<span><span class="co">#&gt; [2,]  345527  316411 1687459 1687459</span></span>
<span><span class="co">#&gt; [3,] 1839144 1687459 9030113 8991343</span></span>
<span><span class="co">#&gt; [4,] 1839144 1687459 8991343 9030113</span></span>
<span></span>
<span><span class="fu">my_add_text</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g_MAP</span>, type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_mean_unknown4-1.png" width="100%"></p>
<p>This <code>S_projected</code> matrix can now be interpreted as a more stable covariance matrix estimator.</p>
<p>We can also interpret the data suggesting there is, for example, the same covariance of “number of deaths after Aspirin” with “number of people treated with *” no matter if the “*” represents the placebo or Aspirin.</p>
</div>
<div class="section level3">
<h3 id="example-2---modeling">Example 2 - modeling<a class="anchor" aria-label="anchor" href="#example-2---modeling"></a>
</h3>
<p>First, construct data for the example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare model, multivariate normal distribution</span></span>
<span><span class="va">perm_size</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">perm_size</span><span class="op">)</span>  </span>
<span><span class="va">sigma_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>,</span>
<span>    <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span>
<span>    <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>,</span>
<span>    <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">perm_size</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="co"># sigma_matrix is a matrix invariant under permutation (1,2,3,4,5,6)</span></span>
<span></span>
<span></span>
<span><span class="co"># Generate example data from a model:</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">2022</span>,</span>
<span>    code <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">4</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">sigma_matrix</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># End of prepare model</span></span></code></pre></div>
<p>Suppose we do not know the true covariance matrix <span class="math inline"><em>Σ</em></span> and we want to estimate it. We cannot use the standard MLE because it does not exists (<span class="math inline">4 &lt; 6</span>, <span class="math inline"><em>n</em> &lt; <em>p</em></span>).</p>
<p><img src="reference/figures/README-example_mean_known1_1-1.png" width="100%"></p>
<p>We will assume it was generated from the normal distribution with the mean <span class="math inline">0</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PrzeChoj/gips" class="external-link">gips</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 6</span></span>
<span><span class="va">number_of_observations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 4</span></span>
<span><span class="va">perm_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="co"># 6</span></span>
<span></span>
<span><span class="co"># Calculate the covariance matrix from the data:</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">Z</span><span class="op">)</span> <span class="op">/</span> <span class="va">number_of_observations</span></span></code></pre></div>
<p>Make the gips object out of data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gips.html">gips</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">number_of_observations</span>, was_mean_estimated <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We can see the standard estimator of the covariance matrix, <span class="math inline"><em>Σ̂</em> = (1/<em>n</em>) ⋅ <em>Σ</em><sub><em>i</em> = 1</sub><sup><em>n</em></sup>(<em>Z</em><sup>(<em>i</em>)</sup> ⋅ (<em>Z</em><sup>(<em>i</em>)</sup><sup>⊤</sup>))</span>. It is not MLE (again, because MLE does not exists for <span class="math inline"><em>n</em> &lt; <em>p</em></span>):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>, type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Covariance estimated in standard way"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_mean_known3_1-1.png" width="100%"></p>
<p>Find the Maximum A Posteriori Estimator for the permutation. Space is small (<span class="math inline">6! = 720</span>), so it is reasonable to browse the whole of it:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/find_MAP.html">find_MAP</a></span><span class="op">(</span><span class="va">g</span>, optimizer <span class="op">=</span> <span class="st">"brute_force"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ================================================================================</span></span>
<span></span>
<span><span class="va">g_map</span></span>
<span><span class="co">#&gt; The permutation (1,2,3,4,5,6)</span></span>
<span><span class="co">#&gt;  - was found after 720 log_posteriori calculations</span></span>
<span><span class="co">#&gt;  - is 504.049 times more likely than the starting, () permutation.</span></span></code></pre></div>
<p>We see that the found permutation is hundreds of times more likely than making no additional assumption. That means the additional assumptions are justified.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g_map</span><span class="op">)</span><span class="op">$</span><span class="va">n0</span> <span class="op">&lt;=</span> <span class="va">number_of_observations</span> <span class="co"># 1 &lt;= 4</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>What is more, we see the number of observations (<span class="math inline">4</span>) is bigger or equal to <span class="math inline"><em>n</em><sub>0</sub> = 1</span>, so we can estimate the covariance matrix with the Maximum Likelihood estimator:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_projected</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/project_matrix.html">project_matrix</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">g_map</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">S_projected</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">#&gt; [1,] 1.3747718 1.0985729 0.6960213 0.4960295 0.6960213 1.0985729</span></span>
<span><span class="co">#&gt; [2,] 1.0985729 1.3747718 1.0985729 0.6960213 0.4960295 0.6960213</span></span>
<span><span class="co">#&gt; [3,] 0.6960213 1.0985729 1.3747718 1.0985729 0.6960213 0.4960295</span></span>
<span><span class="co">#&gt; [4,] 0.4960295 0.6960213 1.0985729 1.3747718 1.0985729 0.6960213</span></span>
<span><span class="co">#&gt; [5,] 0.6960213 0.4960295 0.6960213 1.0985729 1.3747718 1.0985729</span></span>
<span><span class="co">#&gt; [6,] 1.0985729 0.6960213 0.4960295 0.6960213 1.0985729 1.3747718</span></span>
<span></span>
<span><span class="co"># Plot the found matrix:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g_map</span>, type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Covariance estimated with `gips`"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_mean_known6-1.png" width="100%"></p>
<p>We see <code>gips</code> found the data’s structure, and we could estimate the covariance matrix with huge accuracy only with a small amount of data and additional reasonable assumptions.</p>
<p>Note that the rank of the <code>S</code> matrix was 4, while the rank of the <code>S_projected</code> matrix was 6 (full rank).</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h1>
<p>For more examples and introduction, see <code><a href="articles/gips.html">vignette("gips", package="gips")</a></code> or its <a href="https://przechoj.github.io/gips/articles/gips.html">pkgdown page</a>.</p>
</div>
<div class="section level1">
<h1 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h1>
<p>Project was funded by Warsaw University of Technology within the Excellence Initiative: Research University (IDUB) programme.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=gips" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/PrzeChoj/gips/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/PrzeChoj/gips/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing gips</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Adam Przemysław Chojecki <br><small class="roles"> Author, maintainer </small>  </li>
<li>Paweł Morgen <br><small class="roles"> Author </small>  </li>
<li>Bartosz Kołodziejek <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5220-9012" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://CRAN.R-project.org/package=gips" class="external-link"><img src="https://www.r-pkg.org/badges/version/gips" alt="CRAN status"></a></li>
<li><a href="https://github.com/PrzeChoj/gips/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/PrzeChoj/gips/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/PrzeChoj/gips?branch=main" class="external-link"><img src="https://codecov.io/gh/PrzeChoj/gips/branch/main/graph/badge.svg" alt="test-coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Adam Przemysław Chojecki, Paweł Morgen, Bartosz Kołodziejek.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
